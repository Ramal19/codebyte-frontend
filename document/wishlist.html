<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <title>Wishlist</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .post { border: 1px solid #ccc; padding: 15px; margin-bottom: 10px; }
    .cover { width: 200px; height: auto; display: block; margin-bottom: 10px; }
    button { background-color: red; color: white; padding: 5px 10px; border: none; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Wishlist</h1>
  <div id="wishlist"></div>

  <script>
    const wishPost = localStorage.getItem("wishPost");

    async function loadWishlist() {
      const res = await fetch("https://codebyte-backend-ibyq.onrender.com/wishlist", {
        headers: { Authorization: `Bearer ${wishPost}` },
      });
      const data = await res.json();

      const wishlistDiv = document.getElementById("wishlist");
      wishlistDiv.innerHTML = "";

      if (data.length === 0) {
        wishlistDiv.innerHTML = "<p>Wishlist bo≈üdur.</p>";
        return;
      }

      data.forEach(item => {
        const post = item.post;
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `
          <img class="cover" src="https://codebyte-backend-ibyq.onrender.com/uploads/${post.courseCover}" />
          <h3>${post.text}</h3>
          <p><strong>Kateqoriya:</strong> ${post.category}</p>
          <button onclick="removeFromWishlist('${post.id}')">Sil</button>
        `;
        wishlistDiv.appendChild(div);
      });
    }

    async function removeFromWishlist(postId) {
      await fetch(`https://codebyte-backend-ibyq.onrender.com/wishlist/${postId}`, {
        method: "DELETE",
        headers: { Authorization: `Bearer ${wishPost}` },
      });
      loadWishlist();
    }

    loadWishlist();
  </script>
</body>
</html>
